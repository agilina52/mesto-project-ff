{"version":3,"file":"main.js","mappings":"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","sources":["webpack://mesto-project-ff/./src/components/card.js","webpack://mesto-project-ff/./src/components/api.js","webpack://mesto-project-ff/./src/components/modal.js","webpack://mesto-project-ff/./src/components/validation.js","webpack://mesto-project-ff/./src/index.js"],"sourcesContent":["// Функция создания\r\nimport { deleteCardFromServer, like, unlike, updateAvatar } from \"./api\";\r\nconst cardTemplate = document.querySelector(\"#card-template\").content;\r\n\r\nexport function createCard(\r\n  cardData,\r\n  onDeleteCard,\r\n  onLikeCard,\r\n  onOpenImagePopup,\r\n  currentUser\r\n) {\r\n  const cardElement = cardTemplate.cloneNode(true);\r\n  const deleteButton = cardElement.querySelector(\".card__delete-button\");\r\n  const cardImage = cardElement.querySelector(\".card__image\");\r\n  const cardTitle = cardElement.querySelector(\".card__title\");\r\n  const likeButton = cardElement.querySelector(\".card__like-button\");\r\n  const likeCount = cardElement.querySelector(\".card__like-counter\");\r\n\r\n  cardImage.src = cardData.link;\r\n  cardImage.alt = `Изображение места: ${cardData.name}`;\r\n  cardTitle.textContent = cardData.name;\r\n  likeCount.textContent = cardData.likes.length;\r\n\r\n  if (currentUser._id !== cardData.owner._id) {\r\n    deleteButton.hidden = true;\r\n  }\r\n\r\n  // если массив лайкс содержит элемент с идентификатором каррент юзер айди, то добавить на кнопку лайк класс ...is_active\r\n  // как найти элемент массива по атрибуту объекта в массиве (гуглить)\r\n  if (cardData.likes.some((count) => count._id === currentUser._id)) {\r\n    likeButton.classList.add(\"card__like-button_is-active\");\r\n    console.log(cardData.likes, currentUser._id);\r\n  }\r\n\r\n  deleteButton.addEventListener(\"click\", () =>\r\n    onDeleteCard(deleteButton, cardData._id)\r\n  );\r\n  likeButton.addEventListener(\"click\", () =>\r\n    onLikeCard(cardData._id, likeButton, likeCount)\r\n  );\r\n  // cardImage.addEventListener(\"click\", onOpenImagePopup);\r\n  cardImage.addEventListener(\"click\", () => {\r\n    const cardData = {\r\n      src: cardImage.src,\r\n      alt: cardImage.alt,\r\n    };\r\n    onOpenImagePopup(cardData);\r\n  });\r\n\r\n  return cardElement;\r\n}\r\n\r\n// лайк\r\nexport function likeCard(id, likeButton, likeCount) {\r\n  if (likeButton.classList.contains(\"card__like-button_is-active\")) {\r\n    likeButton.classList.remove(\"card__like-button_is-active\");\r\n    unlike(id)\r\n    .then((result) => {\r\n      likeCount.textContent = result.likes.length;\r\n    })\r\n  } else {\r\n    likeButton.classList.add(\"card__like-button_is-active\");\r\n    like(id)\r\n    .then((result) => {\r\n      likeCount.textContent = result.likes.length;\r\n    })\r\n  }\r\n}\r\n\r\n// Функция удаления карточки\r\nexport function deleteCard(deleteButton, id) {\r\n  deleteCardFromServer(id);\r\n  const cardDelete = deleteButton.closest(\".card\");\r\n  cardDelete.remove();\r\n}\r\n","export function deleteCardFromServer(cardId) {\r\n  return new Promise(function (resolve, reject) {\r\n    fetch(`https://nomoreparties.co/v1/wff-cohort-41/cards/${cardId}`, {\r\n      method: \"DELETE\",\r\n      headers: {\r\n        authorization: \"0b29a7a6-71d4-445b-8202-2b632e1e043c\",\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n    })\r\n      .then((res) => {\r\n        if (!res.ok) {\r\n          throw new Error(\"ошибка при удалении\");\r\n        }\r\n\r\n        return res.json();\r\n      })\r\n      .then((result) => {\r\n        console.log(\"карточки удалены\", result);\r\n        resolve(result);\r\n      })\r\n      .catch((err) => {\r\n        console.log(\"ошибка удаления карточек\", err);\r\n        reject(\"Запрос отклонён\");\r\n      });\r\n  });\r\n}\r\n\r\nexport function like(cardId) {\r\n  return new Promise(function (resolve, reject) {\r\n    fetch(`https://nomoreparties.co/v1/wff-cohort-41/cards/likes/${cardId}`, {\r\n      method: \"PUT\",\r\n      headers: {\r\n        authorization: \"0b29a7a6-71d4-445b-8202-2b632e1e043c\",\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n    })\r\n      .then((res) => {\r\n        if (!res.ok) {\r\n          throw new Error(\"ошибка при поставке лайка\");\r\n        }\r\n\r\n        return res.json();\r\n      })\r\n      .then((result) => {\r\n        console.log(\"Лайк поставлен\", result);\r\n        resolve(result);\r\n      })\r\n      .catch((err) => {\r\n        console.log(\"ошибка лайка\", err);\r\n        reject(\"Запрос отклонён\");\r\n      });\r\n  });\r\n}\r\n\r\nexport function unlike(cardId) {\r\n  return new Promise(function (resolve, reject) {\r\n    fetch(`https://nomoreparties.co/v1/wff-cohort-41/cards/likes/${cardId}`, {\r\n      method: \"DELETE\",\r\n      headers: {\r\n        authorization: \"0b29a7a6-71d4-445b-8202-2b632e1e043c\",\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n    })\r\n      .then((res) => {\r\n        if (!res.ok) {\r\n          throw new Error(\"ошибка удалении лайка\");\r\n        }\r\n\r\n        return res.json();\r\n      })\r\n      .then((result) => {\r\n        console.log(\"Лайк удален\", result);\r\n        resolve(result);\r\n      })\r\n      .catch((err) => {\r\n        console.log(\"ошибка лайка\", err);\r\n        reject(\"Запрос отклонён\");\r\n      });\r\n  });\r\n}\r\n\r\nexport function updateAvatar(userPhotoLink) {\r\n  return new Promise(function (resolve, reject) {\r\n    fetch(\"https://nomoreparties.co/v1/wff-cohort-41/users/me/avatar\", {\r\n      method: \"PATCH\",\r\n      headers: {\r\n        authorization: \"0b29a7a6-71d4-445b-8202-2b632e1e043c\",\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n      body: JSON.stringify ({\r\n        avatar: userPhotoLink\r\n      })\r\n    })\r\n      .then((res) => {\r\n        if (!res.ok) {\r\n          throw new Error(\"ошибка обновления аватара\");\r\n        }\r\n\r\n        return res.json();\r\n      })\r\n      .then((result) => {\r\n        console.log(\"аватар обновлён\", result);\r\n        resolve(result);\r\n      })\r\n      .catch((err) => {\r\n        console.log(\"ошибка обновления аватара\", err);\r\n        reject(\"Запрос отклонён\");\r\n      });\r\n  });\r\n}","function closeEscape(event) {\r\n  if (event.key === \"Escape\") {\r\n    const openedModal = document.querySelector(\".popup_is-opened\");\r\n    if (openedModal) {\r\n      closeModal(openedModal);\r\n    }\r\n  }\r\n}\r\n\r\nexport function closeModal(modal) {\r\n  modal.classList.add(\"popup_is-animated\");\r\n  modal.classList.remove(\"popup_is-opened\");\r\n  document.removeEventListener(\"keydown\", closeEscape);\r\n}\r\n\r\nexport function openModal(modal) {\r\n  modal.classList.add(\"popup_is-opened\");\r\n  document.addEventListener(\"keydown\", closeEscape);\r\n}\r\n\r\nexport function closeOverlay(event) {\r\n  if (event.target.classList.contains(\"popup_is-opened\")) {\r\n    closeModal(event.target);\r\n  }\r\n}\r\n\r\nexport function closeBtn(event) {\r\n  if (event.target.classList.contains(\"popup__close\")) {\r\n    const modal = event.target.closest(\".popup_is-opened\");\r\n    closeModal(modal);\r\n  }\r\n}\r\n","// Функция показа ошибки\r\nexport const showInputError = (formElement, inputElement, errorMessage, options) => {\r\n  const errorElement = formElement.querySelector(`.${inputElement.id}-error`);\r\n  console.log(\"!\");\r\n  inputElement.classList.add(options.inputErrorClass);\r\n  errorElement.textContent = errorMessage;\r\n  errorElement.classList.add(options.errorClass);\r\n  console.log(\"ошибка\");\r\n};\r\n// Функция скрытия ошибки\r\nexport const hideInputError = (formElement, inputElement, options) => {\r\n  const errorElement = formElement.querySelector(`.${inputElement.id}-error`);\r\n  console.log();\r\n  inputElement.classList.remove(options.inputErrorClass);\r\n  errorElement.classList.remove(options.errorClass);\r\n  errorElement.textContent = \"\";\r\n};\r\n// Функция проверки валидности\r\nexport const isValid = (formElement, inputElement, options) => {\r\n  if (inputElement.validity.patternMismatch) {\r\n    inputElement.setCustomValidity(inputElement.dataset.errorMessage);\r\n  } else {\r\n    inputElement.setCustomValidity(\"\");\r\n  }\r\n  if (!inputElement.validity.valid) {\r\n    showInputError(formElement, inputElement, inputElement.validationMessage, options);\r\n  } else {\r\n    hideInputError(formElement, inputElement, options);\r\n  }\r\n};\r\n\r\n// Проверка на невалидные поля//\r\nexport const hasInvalidInput = (inputList) => {\r\n  return inputList.some((inputElement) => {\r\n    return !inputElement.validity.valid;\r\n  });\r\n};\r\n\r\n// Переключение состояния кнопки\r\nexport const toggleButtonState = (inputList, buttonElement, options) => {\r\n  if (hasInvalidInput(inputList)) {\r\n    buttonElement.disabled = true;\r\n    buttonElement.classList.add(options.inactiveButtonClass);\r\n  } else {\r\n    buttonElement.disabled = false;\r\n    buttonElement.classList.remove(options.inactiveButtonClass);\r\n  }\r\n};\r\n\r\n// Установка обработчиков событий валидации\r\nexport const setEventListeners = (formElement, options) => {\r\n  const inputList = Array.from(formElement.querySelectorAll(options.inputSelector));\r\n  const buttonElement = formElement.querySelector(options.submitButtonSelector);\r\n  console.log();\r\n  // Инициализация состояния кнопки\r\n  toggleButtonState(inputList, buttonElement, options);\r\n\r\n  inputList.forEach((inputElement) => {\r\n    inputElement.addEventListener(\"input\", () => {\r\n      isValid(formElement, inputElement, options);\r\n      toggleButtonState(inputList, buttonElement, options);\r\n    });\r\n  });\r\n};\r\n\r\n// Включение валидации для всех форм\r\nexport const enableValidation = (options) => {\r\n  const formList = Array.from(document.querySelectorAll(options.formSelector));\r\n  console.log();\r\n\r\n  formList.forEach((formElement) => {\r\n    formElement.addEventListener(\"submit\", (evt) => {\r\n      evt.preventDefault();\r\n    });\r\n\r\n    setEventListeners(formElement, options);\r\n  });\r\n};\r\n\r\nexport const clearValidation = function (modalForm, options) {\r\n  const formInputList = Array.from(modalForm.querySelectorAll(options.inputSelector));\r\n  formInputList.forEach((formInput) => {\r\n    // console.log(`clearValidation formInput.value:${formInput.value}`);\r\n    hideInputError(modalForm, formInput, options);\r\n  });\r\n  console.log(\"clearValidation\");\r\n};","import \"./pages/index.css\";\r\n\r\nimport { createCard, likeCard, deleteCard } from \"./components/card.js\";\r\nimport {\r\n  closeModal,\r\n  openModal,\r\n  closeOverlay,\r\n  closeBtn,\r\n} from \"./components/modal.js\";\r\nimport {\r\n  enableValidation,\r\n  toggleButtonState,\r\n  clearValidation,\r\n} from \"./components/validation.js\";\r\nimport { updateAvatar } from \"./components/api.js\";\r\n\r\nlet currentUser = null;\r\nconst cardList = document.querySelector(\".places__list\");\r\n\r\n// Модальные окна\r\nconst modals = document.querySelectorAll(\".popup\");\r\nconst modalEditProfile = document.querySelector(\".popup_type_edit\");\r\nconst modalAddCard = document.querySelector(\".popup_type_new-card\");\r\nconst modalImage = document.querySelector(\".popup_type_image\");\r\nconst inputNameFormNewCard = modalAddCard.querySelector(\r\n  \".popup__input_type_card-name\"\r\n);\r\nconst inputLinkFormNewCard = modalAddCard.querySelector(\r\n  \".popup__input_type_url\"\r\n);\r\nconst modalImageContent = modalImage.querySelector(\".popup__image\");\r\nconst modalImageCaption = modalImage.querySelector(\".popup__caption\");\r\n\r\nconst modalEditAvatar = document.querySelector(\".popup_type_edit-avatar\");\r\n\r\n// Кнопки открытия модальных форм\r\nconst buttonEditProfile = document.querySelector(\".profile__edit-button\");\r\nconst buttonAddCard = document.querySelector(\".profile__add-button\");\r\n\r\nconst buttonEditAvatar = document.querySelector(\".avatar__edit-button\");\r\n\r\n// Обработка сохранения карточки\r\nconst newCard = modalAddCard.querySelector(\".popup__form\");\r\n\r\n// Редактирование профиля\r\nconst formEditProfile = modalEditProfile.querySelector(\".popup__form\");\r\nconst profileNameInput = formEditProfile.querySelector(\r\n  \".popup__input_type_name\"\r\n);\r\nconst jobInput = formEditProfile.querySelector(\r\n  \".popup__input_type_description\"\r\n);\r\nconst profileName = document.querySelector(\".profile__title\");\r\nconst profileJob = document.querySelector(\".profile__description\");\r\n\r\n// Редактирование аватара\r\nconst formEditAvatar = modalEditAvatar.querySelector(\".popup__form\");\r\n\r\nconst validationOptions = {\r\n  formSelector: \".popup__form\",\r\n  inputSelector: \".popup__input\",\r\n  submitButtonSelector: \".popup__button\",\r\n  inactiveButtonClass: \"popup__button_disabled\",\r\n  inputErrorClass: \"popup__input_type_error\",\r\n  errorClass: \"popup__error_visible\",\r\n};\r\n\r\nfunction openImagePopup(cardData) {\r\n  modalImageContent.src = cardData.src;\r\n  modalImageContent.alt = cardData.alt;\r\n  modalImageCaption.textContent = cardData.alt.replace(\r\n    \"Изображение места: \",\r\n    \"\"\r\n  );\r\n\r\n  openModal(modalImage);\r\n}\r\n\r\nfunction fillProfileForm() {\r\n  profileNameInput.value = profileName.textContent;\r\n  jobInput.value = profileJob.textContent;\r\n}\r\n\r\nconst handleFormSubmitProfile = (evt) => {\r\n  evt.preventDefault();\r\n  const nameValue = profileNameInput.value;\r\n  const jobValue = jobInput.value;\r\n\r\n  closeModal(modalEditProfile);\r\n  updateProfile({\r\n    name: nameValue,\r\n    about: jobValue,\r\n  })\r\n    .then((result) => {\r\n      console.log(result);\r\n      fillUserHeader(result);\r\n    })\r\n    .catch(function (error) {\r\n      console.log(error);\r\n    });\r\n};\r\n\r\n// Прослушиватель нажатия по оверлею\r\nmodals.forEach((modal) => {\r\n  modal.addEventListener(\"click\", closeOverlay);\r\n});\r\n\r\n// Прослушиватель нажатия по кнопке закрытия\r\nmodals.forEach((modal) => {\r\n  modal.addEventListener(\"click\", closeBtn);\r\n});\r\n\r\nenableValidation(validationOptions);\r\n\r\n// Открытие модального окна редактирования автара\r\nbuttonEditAvatar.addEventListener(\"click\", () => {\r\n  openModal(modalEditAvatar);\r\n  clearValidation(modalEditAvatar, validationOptions);\r\n});\r\n\r\n// Открытие модального окна профиля\r\nbuttonEditProfile.addEventListener(\"click\", () => {\r\n  openModal(modalEditProfile);\r\n  clearValidation(modalEditProfile, validationOptions);\r\n});\r\n\r\n// Открытие модального окна добавления карточки\r\nbuttonAddCard.addEventListener(\"click\", () => {\r\n  openModal(modalAddCard);\r\n  const inputList = Array.from(\r\n    modalAddCard.querySelector(validationOptions.formSelector)\r\n  );\r\n  const buttonElement = modalAddCard.querySelector(\r\n    validationOptions.submitButtonSelector\r\n  );\r\n  toggleButtonState(inputList, buttonElement, validationOptions);\r\n});\r\n\r\nconst handleFormSubmitNewCard = (evt) => {\r\n  evt.preventDefault();\r\n  //TODO: в кнопку формы новой карточки поместить тект \"Сохранение...\" если кнопки нет (dom элемента), то перед этим найти ее.\r\n\r\n  const buttonSave = modalAddCard.querySelector(\".popup__button\");\r\n  const textButton = buttonSave.textContent;\r\n  buttonSave.textContent = \"Сохранить...\";\r\n\r\n  const newCardData = {\r\n    name: inputNameFormNewCard.value,\r\n    link: inputLinkFormNewCard.value,\r\n  };\r\n\r\n  addCard(newCardData)\r\n    .then((result) => {\r\n      const cardElement = createCard(\r\n        result,\r\n        deleteCard,\r\n        likeCard,\r\n        openImagePopup,\r\n        currentUser\r\n      );\r\n\r\n      cardList.prepend(cardElement);\r\n      console.log(result);\r\n    })\r\n    .catch((error) => {\r\n      console.log(\"Ошибка при создании карточки:\", error);\r\n    })\r\n    .finally(() => {\r\n      // TODO: вернуть кнопке прежний текст (ее уже не надо искать, она уже определена выше в функции)\r\n      buttonSave.textContent = textButton;\r\n      inputNameFormNewCard.value = \"\";\r\n      inputLinkFormNewCard.value = \"\";\r\n      closeModal(modalAddCard);\r\n    });\r\n};\r\n\r\nnewCard.addEventListener(\"submit\", handleFormSubmitNewCard);\r\n\r\n// Обработка сохранения профиля\r\nconst formProfile = modalEditProfile.querySelector(\".popup__form\");\r\nformProfile.addEventListener(\"submit\", handleFormSubmitProfile);\r\n\r\nformEditProfile.addEventListener(\"submit\", handleFormSubmitProfile);\r\ndocument\r\n  .querySelector(\".profile__edit-button\")\r\n  .addEventListener(\"click\", fillProfileForm);\r\n\r\nconst handleFormSubmitAvatar = (evt) => {\r\n  evt.preventDefault();\r\n  const urlAvatarInput = modalEditAvatar.querySelector(\r\n    \".popup__input_type_url-avatar\"\r\n  );\r\n  const userAvatar = document.querySelector(\".profile__image\");\r\n  //TODO: в кнопку формы новой карточки поместить тект \"Сохранение...\" если кнопки нет (dom элемента), то перед этим найти ее.\r\n  const buttonSave = modalEditAvatar.querySelector(\".popup__button\");\r\n  const textButton = buttonSave.textContent;\r\n  buttonSave.textContent = \"Сохранить...\";\r\n\r\n  const urlAvatarValue = urlAvatarInput.value;\r\n  updateAvatar(urlAvatarValue)\r\n    .then((result) => {\r\n      console.log(result);\r\n      userAvatar.style.backgroundImage = `url(\"${result.avatar}\")`;\r\n    })\r\n    .catch(function (error) {\r\n      console.log(error);\r\n    })\r\n    .finally(function () {\r\n      // TODO: вернуть кнопке прежний текст (ее уже не надо искать, она уже определена выше в функции)\r\n      buttonSave.textContent = textButton;\r\n      closeModal(modalEditAvatar);\r\n    });\r\n};\r\n\r\nformEditAvatar.addEventListener(\"submit\", handleFormSubmitAvatar);\r\n\r\n// загрузка информации о пользователе с сервера\r\nconst getUser = new Promise(function (resolve, reject) {\r\n  fetch(\"https://nomoreparties.co/v1/wff-cohort-41/users/me\", {\r\n    method: \"GET\",\r\n    headers: {\r\n      authorization: \"0b29a7a6-71d4-445b-8202-2b632e1e043c\",\r\n    },\r\n  })\r\n    .then((res) => {\r\n      if (!res.ok) {\r\n        console.log(\"Запрос Users не обработан\");\r\n        throw new Error(\"Error Users!\");\r\n      }\r\n      return res.json();\r\n    })\r\n    .then((result) => {\r\n      console.log(result);\r\n      resolve(result);\r\n    })\r\n    .catch(function (error) {\r\n      console.log(error);\r\n      reject(\"Запрос отклонён\");\r\n    });\r\n});\r\n\r\n// Заполнение шапки профиля\r\nfunction fillUserHeader(userProfile) {\r\n  const userName = document.querySelector(\".profile__title\");\r\n  const userAbout = document.querySelector(\".profile__description\");\r\n  const userAvatar = document.querySelector(\".profile__image\");\r\n  //   const userId = document.querySelector(\".\");\r\n  userName.textContent = userProfile.name;\r\n  userAbout.textContent = userProfile.about;\r\n  userAvatar.style.backgroundImage = `url(\"${userProfile.avatar}\")`;\r\n}\r\n\r\n// загрузка карточек с сервера\r\nconst getCards = new Promise(function (resolve, reject) {\r\n  fetch(\"https://nomoreparties.co/v1/wff-cohort-41/cards\", {\r\n    headers: {\r\n      authorization: \"0b29a7a6-71d4-445b-8202-2b632e1e043c\",\r\n    },\r\n  })\r\n    .then((res) => {\r\n      if (!res.ok) {\r\n        console.log(\"Запрос Cards не обработан\");\r\n        throw new Error(\"Error Cards!\");\r\n      }\r\n      return res.json();\r\n    })\r\n    .then((result) => {\r\n      console.log(result);\r\n      resolve(result);\r\n    })\r\n    .catch(function (error) {\r\n      console.log(error);\r\n      reject(\"Запрос отклонён\");\r\n    });\r\n});\r\n\r\n// массив промисов\r\nconst promises = [getUser, getCards];\r\nPromise.all(promises)\r\n  .then((results) => {\r\n    console.log(results);\r\n    currentUser = results[0];\r\n    results[1].forEach(function (element) {\r\n      const cardElement = createCard(\r\n        element,\r\n        deleteCard,\r\n        likeCard,\r\n        openImagePopup,\r\n        currentUser\r\n      );\r\n      cardList.append(cardElement);\r\n    });\r\n    fillUserHeader(results[0]);\r\n  })\r\n  .catch((err) => {\r\n    console.log(err);\r\n  });\r\n\r\n// Обновление профиля на сервере\r\nfunction updateProfile(userProfile) {\r\n  return new Promise(function (resolve, reject) {\r\n    fetch(\"https://nomoreparties.co/v1/wff-cohort-41/users/me\", {\r\n      method: \"PATCH\",\r\n      headers: {\r\n        authorization: \"0b29a7a6-71d4-445b-8202-2b632e1e043c\",\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n      body: JSON.stringify(userProfile),\r\n    })\r\n      .then((res) => {\r\n        if (!res.ok) {\r\n          throw new Error(\"ошибка при обновлении профиля\");\r\n        }\r\n\r\n        return res.json();\r\n      })\r\n      .then((result) => {\r\n        console.log(\"профиль обновлен\", result);\r\n        resolve(result);\r\n      })\r\n      .catch((err) => {\r\n        console.log(\"ошибка обновления\", err);\r\n        reject(\"Запрос отклонён\");\r\n      });\r\n  });\r\n}\r\n\r\n// Добавление карточки\r\nfunction addCard(cardData) {\r\n  return new Promise(function (resolve, reject) {\r\n    fetch(\"https://nomoreparties.co/v1/wff-cohort-41/cards\", {\r\n      method: \"POST\",\r\n      headers: {\r\n        authorization: \"0b29a7a6-71d4-445b-8202-2b632e1e043c\",\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n      body: JSON.stringify(cardData),\r\n    })\r\n      .then((res) => {\r\n        if (!res.ok) {\r\n          throw new Error(\"ошибка при добавлении карточек\");\r\n        }\r\n\r\n        return res.json();\r\n      })\r\n      .then((result) => {\r\n        console.log(\"карточки добавлены\", result);\r\n        resolve(result);\r\n      })\r\n      .catch((err) => {\r\n        console.log(\"ошибка добавления карточек\", err);\r\n        reject(\"Запрос отклонён\");\r\n      });\r\n  });\r\n}\r\n"],"names":["cardTemplate","document","querySelector","content","createCard","cardData","onDeleteCard","onLikeCard","onOpenImagePopup","currentUser","cardElement","cloneNode","deleteButton","cardImage","cardTitle","likeButton","likeCount","src","link","alt","concat","name","textContent","likes","length","_id","owner","hidden","some","count","classList","add","console","log","addEventListener","likeCard","id","cardId","contains","remove","Promise","resolve","reject","fetch","method","headers","authorization","then","res","ok","Error","json","result","catch","err","like","deleteCard","closest","closeEscape","event","key","openedModal","closeModal","modal","removeEventListener","openModal","closeOverlay","target","closeBtn","hideInputError","formElement","inputElement","options","errorElement","inputErrorClass","errorClass","toggleButtonState","inputList","buttonElement","validity","valid","hasInvalidInput","disabled","inactiveButtonClass","clearValidation","modalForm","Array","from","querySelectorAll","inputSelector","forEach","formInput","cardList","modals","modalEditProfile","modalAddCard","modalImage","inputNameFormNewCard","inputLinkFormNewCard","modalImageContent","modalImageCaption","modalEditAvatar","buttonEditProfile","buttonAddCard","buttonEditAvatar","newCard","formEditProfile","profileNameInput","jobInput","profileName","profileJob","formEditAvatar","validationOptions","formSelector","submitButtonSelector","openImagePopup","replace","formList","handleFormSubmitProfile","evt","preventDefault","userProfile","nameValue","value","jobValue","about","body","JSON","stringify","fillUserHeader","error","userName","userAbout","userAvatar","style","backgroundImage","avatar","patternMismatch","setCustomValidity","dataset","errorMessage","showInputError","validationMessage","isValid","setEventListeners","buttonSave","textButton","newCardData","prepend","finally","urlAvatarInput","userPhotoLink","urlAvatarValue","promises","all","results","element","append"],"sourceRoot":""}